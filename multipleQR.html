<!DOCTYPE html>
<html>
  <head>
    <title>QR Code Generator</title>
    <style>
      .qr-element {
        padding: 20px;
        margin-bottom: 20px;
        display: block;
      }
    </style>
  </head>
  <body>
    <textarea
      id="text-input"
      oninput="updateRemainingChars()"
      style="width: 600px; height: 400px"
    ></textarea
    ><br />
    <div id="input-chars"></div>
    <p>[full-width characters will be removed]</p>
    <button onclick="generateQRCode()">Generate QR Code</button>
    <button onclick="resetText()">Reset</button>

    <div id="qrcode-area"></div>

    <script src="https://cdn.jsdelivr.net/npm/qrcodejs@1.0.0/qrcode.min.js"></script>
    <script src="main.js"></script>
  </body>
</html>

<script>
  function resetText() {
    document.getElementById("text-input").value = "";
    updateRemainingChars();
  }

  function updateRemainingChars() {
    const textInput = document.getElementById("text-input").value;
    const inputChars = textInput.length;
    document.getElementById(
      "input-chars"
    ).innerText = `Input Chars: ${inputChars}`;
  }
  function generateQRCode() {
    let text = document.getElementById("text-input").value;

    text = text.replace(/[^\x01-\x7E]/g, "");

    const qrcodeArea = document.getElementById("qrcode-area");
    qrcodeArea.innerHTML = "";

    const chunkSize = 1200;

    const numChunks = Math.ceil(text.length / chunkSize);

    const splitInfo = document.createElement("div");
    splitInfo.innerHTML = `The text has been split into ${numChunks} parts.`;
    qrcodeArea.appendChild(splitInfo);

    for (let i = 0; i < numChunks; i++) {
      const chunk = text.slice(i * chunkSize, (i + 1) * chunkSize);

      const qrDiv = document.createElement("div");
      qrDiv.className = "qr-element";

      const qr = new QRCode(qrDiv, {
        text: chunk,
        width: 450,
        height: 450,
        version: 40,
      });

      qrcodeArea.appendChild(qrDiv);
    }
  }
  updateRemainingChars();
</script>
